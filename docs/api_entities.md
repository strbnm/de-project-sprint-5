### Описание витрины

Состав витрины:

- `id` — идентификатор записи, автоматически генерируемый.
- `courier_id` — ID курьера, которому перечисляем. Берем из таблицы `dm_couriers`.
- `courier_name` — Ф. И. О. курьера. Берем из таблицы `dm_couriers`.
- `settlement_year` — год отчёта. Берем из таблицы `dm_timestamps`.
- `settlement_month` — месяц отчёта, где 1 — январь и 12 — декабрь. Берем из таблицы `dm_timestamps`.
- `orders_count` — количество заказов за период (месяц). Расчетное значение.
- `orders_total_sum` — общая стоимость заказов. Расчетное значение. Стоимость доставки в таблице `dm_deliveries`. 
- `rate_avg` — средний рейтинг курьера по оценкам пользователей. Расчетное значение на основе рейтингов за доставку из таблицы `dm_deliveries`.
- `order_processing_fee` — сумма, удержанная компанией за обработку заказов, которая высчитывается как orders_total_sum * 0.25. Расчетное значение.
- `courier_order_sum` — сумма, которую необходимо перечислить курьеру за доставленные им/ей заказы. За каждый доставленный заказ курьер должен получить некоторую сумму в зависимости от рейтинга (см. ниже). Расчетное значение.
- `courier_tips_sum` — сумма, которую пользователи оставили курьеру в качестве чаевых. Берем из таблицы `dm_deliveries`.
- `courier_reward_sum` — сумма, которую необходимо перечислить курьеру. Вычисляется как courier_order_sum + courier_tips_sum * 0.95 (5% — комиссия за обработку платежа). Расчетное значение.

### Список используемых таблиц в слое DDS
1. Таблица курьеров `dm_couriers`
- `id` - уникальный идентификатор, serial, primary key
- `courier_id` - ID курьера, varchar
- `courier_name` - Ф. И. О. курьера, varchar

2. Таблица доставок `dm_deliveries`
- `id` - уникальный идентификатор, serial, primary key
- `courier_id` - внешний ключ на курьера в таблице `dm_couriers`, int
- `delivery_id` - ID доставки, varchar
- `rate` - оценка, которую поставил пользователь курьеру, int
- `delivery_sum` - стоимость доставленного заказа. Значение в данном поле отличается от значений суммы заказа в поле fct_product_sales. numeric(14,2)
- `tip_sum` - сумма чаевых, которые оставил покупатель курьеру, numeric(14,2)

### Сущности, загружаемые из API
GET /couriers - информация по курьерам
GET / deliveries - информация о доставках

### Таблицы в stg
1. Таблица с данными по курьерам
- `id` - serial, primary key
- `_id` - идентификатор курьера, varchar
- `name` - Ф.И.О. курьера, varchar
- `json` - json, который получаем от API, jsonb
- `created_at` - время создания записи


2. Таблица с данными по доставкам
- `id` - serial, primary key
- `order_id` - идентификатор заказа, varchar
- `order_ts` - время заказа, timestamp
- `delivery_id` - идентификатор доставки, varchar
- `rate` - оценка курьера, int
- `sum` - сумма заказа, numeric(14,2)
- `tip_sum` - сумма чаевых, numeric(14,2)
- `json` - json, который получаем от API, jsonb
- `created_at` - время создания записи
